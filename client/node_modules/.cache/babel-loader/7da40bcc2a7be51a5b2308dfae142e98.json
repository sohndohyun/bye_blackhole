{"ast":null,"code":"import _classCallCheck from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Canvas from'./Canvas';import Ball from'./Ball';import Wall from'./Wall';import Player from'./Player';import GameObject from'./GameObject';import socket from'./PongSocket';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Game=/*#__PURE__*/function(_React$Component){_inherits(Game,_React$Component);var _super=_createSuper(Game);function Game(props){var _this;_classCallCheck(this,Game);_this=_super.call(this,props);_this.objs=void 0;_this.width=void 0;_this.height=void 0;_this.aname=void 0;_this.bname=void 0;_this.ball=void 0;_this.playerL=void 0;_this.playerR=void 0;_this.ballSpeed=void 0;_this.isLadder=void 0;_this.pos=void 0;_this.objs=[];_this.width=800;_this.height=450;_this.ball=new Ball(_assertThisInitialized(_this),20,20,_this.width/2,_this.height/2);_this.playerL=new Player(_assertThisInitialized(_this),20,_this.height/4,0,_this.height/5*2);_this.playerR=new Player(_assertThisInitialized(_this),20,_this.height/4,_this.width-20,_this.height/5*2);_this.state={SL:0,SR:0};_this.pos=_this.props.dr;_this.aname=_this.props.a;_this.bname=_this.props.b;_this.isLadder=_this.props.ladder;_this.ballSpeed=_this.props.speed?700:500;_this.objs.push(_this.playerL);_this.objs.push(_this.playerR);_this.objs.push(new Wall(_assertThisInitialized(_this),_this.width,20,0,0));_this.objs.push(new Wall(_assertThisInitialized(_this),_this.width,20,0,_this.height-20));_this.objs.push(new GameObject(_assertThisInitialized(_this),10,_this.height,_this.width/2-5,0));_this.objs.push(_this.ball);return _this;}_createClass(Game,[{key:\"receivedMessage\",value:function receivedMessage(message){console.log(message);}},{key:\"draw\",value:function draw(ctx,dt){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);for(var i=0;i<this.objs.length;i++){this.objs[i].draw(ctx,dt);}}},{key:\"onKeyDown\",value:function onKeyDown(e){if(this.pos>=2)return;var mypl=this.pos===0?this.playerL:this.playerR;if(e.keyCode===40&&mypl.dirY!==1){socket.emit('Down',mypl.y);}else if(e.keyCode===38&&mypl.dirY!==-1){socket.emit('Up',mypl.y);}}},{key:\"onKeyUp\",value:function onKeyUp(e){if(this.pos>=2)return;var mypl=this.pos===0?this.playerL:this.playerR;if(e.keyCode===40||e.keyCode===38){socket.emit('Stop',mypl.y);}}},{key:\"onUp\",value:function onUp(e){if(e.who===0){this.playerL.dirY=-1;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=-1;this.playerR.y=e.y;}}},{key:\"onDown\",value:function onDown(e){if(e.who===0){this.playerL.dirY=1;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=1;this.playerR.y=e.y;}}},{key:\"onStop\",value:function onStop(e){if(e.who===0){this.playerL.dirY=0;this.playerL.y=e.y;}else if(e.who===1){this.playerR.dirY=0;this.playerR.y=e.y;}}},{key:\"onScored\",value:function onScored(e){this.setState(function(){return{SL:e.scoreL,SR:e.scoreR};});this.ball.start(this.ballSpeed,e.dirX,e.dirY);}},{key:\"onUpdate\",value:function onUpdate(e){this.ball.onUpdate(e);}},{key:\"onScoredL\",value:function onScoredL(){if(this.pos===0){socket.emit('Scored',0);}}},{key:\"onScoredR\",value:function onScoredR(){if(this.pos===0){socket.emit('Scored',1);}}},{key:\"render\",value:function render(){var _this$state=this.state,SL=_this$state.SL,SR=_this$state.SR;var str=\"\".concat(this.isLadder?\"LADDER\":\"NORMAL\",\" \").concat(this.aname,\" \").concat(SL,\" : \").concat(SR,\" \").concat(this.bname);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:str}),/*#__PURE__*/_jsx(Canvas,{game:this})]});}}]);return Game;}(React.Component);export default Game;","map":{"version":3,"sources":["/Users/sohndohyun/works/transcendence/client/src/Pong/Game.tsx"],"names":["React","Canvas","Ball","Wall","Player","GameObject","socket","Game","props","objs","width","height","aname","bname","ball","playerL","playerR","ballSpeed","isLadder","pos","state","SL","SR","dr","a","b","ladder","speed","push","message","console","log","ctx","dt","clearRect","canvas","i","length","draw","e","mypl","keyCode","dirY","emit","y","who","setState","scoreL","scoreR","start","dirX","onUpdate","str","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Canvas from './Canvas';\nimport Ball from './Ball';\nimport Wall from './Wall';\nimport Player from './Player';\nimport GameObject from './GameObject';\nimport socket from './PongSocket';\n\nexport interface Scored {\n    scoreL: number,\n    scoreR: number,\n    dirX: number,\n    dirY: number\n}\n\nexport interface Update {\n    x: number,\n    y: number,\n    dirX: number,\n    dirY: number\n}\n\nexport interface Moved {\n    who: number,\n    y: number\n}\n\nclass Game extends React.Component<any, any> {\n    objs: GameObject[];\n    width: number;\n    height: number;\n\n    aname: string;\n    bname: string;\n\n    ball: Ball;\n    playerL: Player;\n    playerR: Player;\n    ballSpeed: number;\n    isLadder : boolean;\n    pos: number;\n\n    constructor(props: {}) {\n        super(props);\n        this.objs = [];\n        this.width = 800;\n        this.height = 450;\n        this.ball = new Ball(this, 20, 20, this.width / 2, this.height / 2);\n        this.playerL = new Player(this, 20, this.height / 4, 0, this.height / 5 * 2);\n        this.playerR = new Player(this, 20, this.height / 4, this.width - 20, this.height / 5 * 2);\n\n        this.state = {\n            SL: 0,\n            SR: 0\n        };\n\n        this.pos = this.props.dr;\n        this.aname = this.props.a;\n        this.bname = this.props.b;\n        this.isLadder = this.props.ladder;\n        this.ballSpeed = this.props.speed ? 700 : 500;\n\n        this.objs.push(this.playerL);\n        this.objs.push(this.playerR);\n        this.objs.push(new Wall(this, this.width, 20, 0, 0));\n        this.objs.push(new Wall(this, this.width, 20, 0, this.height - 20));\n        this.objs.push(new GameObject(this, 10, this.height, this.width / 2 - 5, 0));\n        this.objs.push(this.ball);\n    }\n\n    receivedMessage(message: string) {\n        console.log(message);\n    }\n\n    draw(ctx: any, dt: number) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\n        for (let i = 0; i < this.objs.length; i++)\n            this.objs[i].draw(ctx, dt);\n    }\n\n    onKeyDown(e: KeyboardEvent) {\n        if (this.pos >= 2)\n            return;\n\n        let mypl = this.pos === 0 ? this.playerL : this.playerR;\n        if (e.keyCode === 40 && mypl.dirY !== 1) {\n            socket.emit('Down', mypl.y);\n        }\n        else if (e.keyCode === 38 && mypl.dirY !== -1) {\n            socket.emit('Up', mypl.y);\n        }\n    }\n\n    onKeyUp(e: KeyboardEvent) {\n        if (this.pos >= 2)\n            return;\n\n        let mypl = this.pos === 0 ? this.playerL : this.playerR;\n        if (e.keyCode === 40 || e.keyCode === 38) {\n            socket.emit('Stop', mypl.y);\n        }\n    }\n\n    onUp(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = -1;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = -1;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onDown(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = 1;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = 1;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onStop(e: Moved) {\n        if (e.who === 0) {\n            this.playerL.dirY = 0;\n            this.playerL.y = e.y;\n        }\n        else if (e.who === 1) {\n            this.playerR.dirY = 0;\n            this.playerR.y = e.y;\n        }\n    }\n\n    onScored(e: Scored) {\n        this.setState(() => { return { SL: e.scoreL, SR: e.scoreR }; });\n\n        this.ball.start(this.ballSpeed, e.dirX, e.dirY);\n    }\n\n    onUpdate(e: Update) {\n        this.ball.onUpdate(e);\n    }\n\n    onScoredL() {\n        if (this.pos === 0) {\n            socket.emit('Scored', 0);\n        }\n    }\n\n    onScoredR() {\n        if (this.pos === 0) {\n            socket.emit('Scored', 1);\n        }\n    }\n\n    render() {\n        const { SL, SR } = this.state;\n\n        let str = `${this.isLadder ? \"LADDER\" : \"NORMAL\"} ${this.aname} ${SL} : ${SR} ${this.bname}`;\n\n        return (\n            <div>\n                <h1>{str}</h1>\n                <Canvas game={this} />\n            </div>\n        );\n    }\n}\n\nexport default Game;\n"]},"metadata":{},"sourceType":"module"}