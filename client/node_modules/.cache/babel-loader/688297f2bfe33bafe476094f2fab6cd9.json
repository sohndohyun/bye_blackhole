{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jinkim/jin_bye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jinkim/jin_bye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import useSwr from'swr';import\"./styles/GetChatList.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var GetChatList=function GetChatList(props){var myID=props.myID;var fetcher=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var res,currentRoom,leave,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!myID){_context.next=6;break;}_context.next=3;return axios.get(url);case 3:res=_context.sent;//kick or ban\nif(window.location.pathname==='/chat'||window.location.pathname==='/Chat'){currentRoom=sessionStorage.getItem('roomName');leave=true;for(i=0;i<res.data.length;i++){if(res.data[i].title===currentRoom)leave=false;}if(leave){window.location.href='/lobby';sessionStorage.removeItem('roomName');}}return _context.abrupt(\"return\",res.data);case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetcher(_x){return _ref.apply(this,arguments);};}();var _useSwr=useSwr('/Lobby/myChatList?id='+myID,fetcher),data=_useSwr.data,error=_useSwr.error,mutate=_useSwr.mutate;var DelChat=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(title){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.delete('Lobby?title='+title+'&id='+myID);case 2:if((window.location.pathname==='/chat'||window.location.pathname==='/Chat')&&sessionStorage.getItem('roomName')===title){window.location.href='/lobby';sessionStorage.removeItem('roomName');}mutate();case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function DelChat(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"# my chats\"}),data===null||data===void 0?void 0:data.map(function(chat){return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"chat-btn\",onClick:function onClick(){document.location.href='/Chat';sessionStorage.setItem('roomName',chat.title);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"chatNum\",children:chat.num}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\xA0\",chat.title]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"chatLeave\",onClick:function onClick(){return DelChat(chat.title);},children:\"X\"})]});})]});};export default GetChatList;","map":{"version":3,"sources":["/Users/jinkim/jin_bye/client/src/SideBar/GetChatList.tsx"],"names":["axios","useSwr","GetChatList","props","myID","fetcher","url","get","res","window","location","pathname","currentRoom","sessionStorage","getItem","leave","i","data","length","title","href","removeItem","error","mutate","DelChat","delete","map","chat","document","setItem","num"],"mappings":"mSAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,KAAnB,CACA,MAAO,2BAAP,C,6IAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAgB,IAC5BC,CAAAA,IAD4B,CACpBD,KADoB,CAC5BC,IAD4B,CAGnC,GAAMC,CAAAA,OAAO,0FAAG,iBAAOC,GAAP,kJACXF,IADW,+CAGIJ,CAAAA,KAAK,CAACO,GAAN,CAAUD,GAAV,CAHJ,QAGRE,GAHQ,eAKd;AACA,GAAIC,MAAM,CAACC,QAAP,CAAgBC,QAAhB,GAA6B,OAA7B,EAAwCF,MAAM,CAACC,QAAP,CAAgBC,QAAhB,GAA6B,OAAzE,CACA,CACOC,WADP,CACqBC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CADrB,CAEKC,KAFL,CAEa,IAFb,CAIC,IAAQC,CAAR,CAAY,CAAZ,CAAeA,CAAC,CAAGR,GAAG,CAACS,IAAJ,CAASC,MAA5B,CAAoCF,CAAC,EAArC,CACA,CACC,GAAIR,GAAG,CAACS,IAAJ,CAASD,CAAT,EAAYG,KAAZ,GAAsBP,WAA1B,CACCG,KAAK,CAAG,KAAR,CACD,CAED,GAAIA,KAAJ,CACA,CACCN,MAAM,CAACC,QAAP,CAAgBU,IAAhB,CAAuB,QAAvB,CACAP,cAAc,CAACQ,UAAf,CAA0B,UAA1B,EACA,CACD,CAtBa,gCAuBPb,GAAG,CAACS,IAvBG,wDAAH,kBAAPZ,CAAAA,OAAO,4CAAb,CAHmC,YA8BLJ,MAAM,CAAgC,wBAA0BG,IAA1D,CAAgEC,OAAhE,CA9BD,CA8B5BY,IA9B4B,SA8B5BA,IA9B4B,CA8BtBK,KA9BsB,SA8BtBA,KA9BsB,CA8BfC,MA9Be,SA8BfA,MA9Be,CAgCnC,GAAMC,CAAAA,OAAO,2FAAG,kBAAML,KAAN,6IACTnB,CAAAA,KAAK,CAACyB,MAAN,CAAa,eAAiBN,KAAjB,CAAyB,MAAzB,CAAkCf,IAA/C,CADS,QAEf,GAAI,CAACK,MAAM,CAACC,QAAP,CAAgBC,QAAhB,GAA6B,OAA7B,EAAwCF,MAAM,CAACC,QAAP,CAAgBC,QAAhB,GAA6B,OAAtE,GAAkFE,cAAc,CAACC,OAAf,CAAuB,UAAvB,IAAuCK,KAA7H,CACA,CACCV,MAAM,CAACC,QAAP,CAAgBU,IAAhB,CAAuB,QAAvB,CACAP,cAAc,CAACQ,UAAf,CAA0B,UAA1B,EACA,CACDE,MAAM,GAPS,wDAAH,kBAAPC,CAAAA,OAAO,8CAAb,CAUA,mBACA,wCACC,YAAK,SAAS,CAAC,OAAf,wBADD,CAEEP,IAFF,SAEEA,IAFF,iBAEEA,IAAI,CAAES,GAAN,CAAU,SAAAC,IAAI,qBACd,aAAK,SAAS,CAAC,MAAf,wBACC,gBAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,UAAhC,CAA2C,OAAO,CAAE,kBAAM,CACxDC,QAAQ,CAAClB,QAAT,CAAkBU,IAAlB,CAAyB,OAAzB,CACAP,cAAc,CAACgB,OAAf,CAAuB,UAAvB,CAAmCF,IAAI,CAACR,KAAxC,EACD,CAHD,wBAIC,aAAM,SAAS,CAAC,SAAhB,UAA2BQ,IAAI,CAACG,GAAhC,EAJD,cAKC,+BAAaH,IAAI,CAACR,KAAlB,GALD,GADD,cAQC,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,WAAhC,CAA4C,OAAO,CAAE,yBAAMK,CAAAA,OAAO,CAACG,IAAI,CAACR,KAAN,CAAb,EAArD,eARD,GADc,EAAd,CAFF,GADA,CAiBA,CA3DD,CA6DA,cAAejB,CAAAA,WAAf","sourcesContent":["import axios from \"axios\";\nimport useSwr from 'swr';\nimport \"./styles/GetChatList.scss\"\n\nconst GetChatList = (props: any) => {\n\tconst {myID} = props\n\n\tconst fetcher = async (url:string) => {\n\t\tif (myID)\n\t\t{\n\t\t\tconst res = await axios.get(url)\n\n\t\t\t//kick or ban\n\t\t\tif (window.location.pathname === '/chat' || window.location.pathname === '/Chat')\n\t\t\t{\n\t\t\t\tconst currentRoom = sessionStorage.getItem('roomName')\n\t\t\t\tvar leave = true\n\t\t\t\t\n\t\t\t\tfor(let i = 0; i < res.data.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (res.data[i].title === currentRoom)\n\t\t\t\t\t\tleave = false\n\t\t\t\t}\n\n\t\t\t\tif (leave)\n\t\t\t\t{\n\t\t\t\t\twindow.location.href = '/lobby'\n\t\t\t\t\tsessionStorage.removeItem('roomName')\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res.data;\n\t\t}\n\t}\n\n\tconst {data, error, mutate} = useSwr<{title:string, num: number}[]>('/Lobby/myChatList?id=' + myID, fetcher)\n\n\tconst DelChat = async(title:string) => {\n\t\tawait axios.delete('Lobby?title=' + title + '&id=' + myID)\n\t\tif ((window.location.pathname === '/chat' || window.location.pathname === '/Chat') && sessionStorage.getItem('roomName') === title)\n\t\t{\n\t\t\twindow.location.href = '/lobby'\n\t\t\tsessionStorage.removeItem('roomName')\n\t\t}\n\t\tmutate()\n\t}\n\n\treturn (\n\t<>\n\t\t<div className=\"title\"># my chats</div>\n\t\t{data?.map(chat=>\n\t\t\t<div className=\"chat\">\n\t\t\t\t<button type=\"button\" className=\"chat-btn\" onClick={() => {\n\t\t\t\t\t\tdocument.location.href = '/Chat';\n\t\t\t\t\t\tsessionStorage.setItem('roomName', chat.title);\n\t\t\t\t}}>\n\t\t\t\t\t<span className=\"chatNum\">{chat.num}</span>\n\t\t\t\t\t<span>&nbsp;{chat.title}</span>\n\t\t\t\t</button>\n\t\t\t\t<button type=\"button\" className=\"chatLeave\" onClick={() => DelChat(chat.title)}>X</button>\n\t\t\t</div>\n\t\t)}\n\t</>\n\t)\n}\n\nexport default GetChatList"]},"metadata":{},"sourceType":"module"}