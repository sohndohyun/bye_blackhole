{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sohndohyun/works/transcendence/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import React,{useEffect,useState}from'react';import'./styles/Auth.scss';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Auth=function Auth(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),IntraID=_useState2[0],setIntraID=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),AuthCode=_useState4[0],setAuthCode=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),WrongCode=_useState6[0],setWrongCode=_useState6[1];useEffect(function(){var url=window.location.href.split('?');if(url[1]){var intra_id=url[1].split('=');if(intra_id[0]==='intra_id'){setIntraID(intra_id[1]);sessionStorage.setItem('intraID',intra_id[1]);sessionStorage.setItem('2auth','false');}}});var handleAuthCodeChange=function handleAuthCodeChange(e){setAuthCode(e.target.value);};var authCheck=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post('/log/2-factor-auth',{intra_id:IntraID,auth_value:AuthCode});case 2:res=_context.sent;if(res.data.auth_result){sessionStorage.setItem('2auth','true');if(res.data.id){sessionStorage.setItem('nickname',res.data.id);document.location.href='/lobby';}else document.location.href='/admin';}else{setWrongCode(true);}case 4:case\"end\":return _context.stop();}}},_callee);}));return function authCheck(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"auth-comment\",children:[IntraID,\"@student.42seoul.kr\\uB85C \\uBA54\\uC77C\\uC774 \\uBC1C\\uC1A1\\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\uC778\\uC99D \\uCF54\\uB4DC\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694\",onChange:handleAuthCodeChange}),/*#__PURE__*/_jsx(\"button\",{onClick:authCheck,className:\"auth-btn\",children:\"\\uD655\\uC778\"})]}),WrongCode?/*#__PURE__*/_jsx(\"div\",{className:\"wrong-code\",children:\"\\uC798\\uBABB\\uB41C \\uCF54\\uB4DC\\uC785\\uB2C8\\uB2E4.\"}):null]});};export default Auth;","map":{"version":3,"sources":["/Users/sohndohyun/works/transcendence/client/src/Auth/Auth.tsx"],"names":["axios","React","useEffect","useState","Auth","IntraID","setIntraID","AuthCode","setAuthCode","WrongCode","setWrongCode","url","window","location","href","split","intra_id","sessionStorage","setItem","handleAuthCodeChange","e","target","value","authCheck","post","auth_value","res","data","auth_result","id","document"],"mappings":"seAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAO,oBAAP,C,wFAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAM,eACaD,QAAQ,CAAC,EAAD,CADrB,wCACVE,OADU,eACDC,UADC,8BAEeH,QAAQ,CAAC,EAAD,CAFvB,yCAEVI,QAFU,eAEAC,WAFA,8BAGiBL,QAAQ,CAAC,KAAD,CAHzB,yCAGVM,SAHU,eAGCC,YAHD,eAKjBR,SAAS,CAAC,UAAM,CACd,GAAMS,CAAAA,GAAG,CAAGC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,GAA3B,CAAZ,CACA,GAAIJ,GAAG,CAAC,CAAD,CAAP,CAAY,CACV,GAAMK,CAAAA,QAAQ,CAAGL,GAAG,CAAC,CAAD,CAAH,CAAOI,KAAP,CAAa,GAAb,CAAjB,CACA,GAAIC,QAAQ,CAAC,CAAD,CAAR,GAAgB,UAApB,CAAgC,CAC9BV,UAAU,CAACU,QAAQ,CAAC,CAAD,CAAT,CAAV,CACAC,cAAc,CAACC,OAAf,CAAuB,SAAvB,CAAkCF,QAAQ,CAAC,CAAD,CAA1C,EACAC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAgC,OAAhC,EACD,CACF,CACF,CAVQ,CAAT,CAYA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,CAAD,CAAY,CACvCZ,WAAW,CAACY,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX,CACD,CAFD,CAIA,GAAMC,CAAAA,SAAS,0FAAG,iKACEvB,CAAAA,KAAK,CAACwB,IAAN,CAAW,oBAAX,CAAiC,CACjDR,QAAQ,CAAEX,OADuC,CAEjDoB,UAAU,CAAElB,QAFqC,CAAjC,CADF,QACVmB,GADU,eAMhB,GAAIA,GAAG,CAACC,IAAJ,CAASC,WAAb,CAA0B,CACxBX,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAgC,MAAhC,EACA,GAAIQ,GAAG,CAACC,IAAJ,CAASE,EAAb,CAAiB,CACfZ,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAmCQ,GAAG,CAACC,IAAJ,CAASE,EAA5C,EACAC,QAAQ,CAACjB,QAAT,CAAkBC,IAAlB,CAAyB,QAAzB,CACD,CAHD,IAGOgB,CAAAA,QAAQ,CAACjB,QAAT,CAAkBC,IAAlB,CAAyB,QAAzB,CACR,CAND,IAMO,CACLJ,YAAY,CAAC,IAAD,CAAZ,CACD,CAde,sDAAH,kBAATa,CAAAA,SAAS,0CAAf,CAiBA,mBACE,aAAK,SAAS,CAAC,UAAf,wBACE,aAAK,SAAS,CAAC,cAAf,WACGlB,OADH,8FADF,cAIE,oCACE,cACE,WAAW,CAAC,sEADd,CAEE,QAAQ,CAAEc,oBAFZ,EADF,cAKE,eAAQ,OAAO,CAAEI,SAAjB,CAA4B,SAAS,CAAC,UAAtC,0BALF,GAJF,CAaGd,SAAS,cAAG,YAAK,SAAS,CAAC,YAAf,gEAAH,CAAkD,IAb9D,GADF,CAiBD,CAvDD,CAyDA,cAAeL,CAAAA,IAAf","sourcesContent":["import axios from 'axios';\nimport React, { useEffect, useState } from 'react';\nimport './styles/Auth.scss';\n\nconst Auth = () => {\n  const [IntraID, setIntraID] = useState('');\n  const [AuthCode, setAuthCode] = useState('');\n  const [WrongCode, setWrongCode] = useState(false);\n\n  useEffect(() => {\n    const url = window.location.href.split('?');\n    if (url[1]) {\n      const intra_id = url[1].split('=');\n      if (intra_id[0] === 'intra_id') {\n        setIntraID(intra_id[1]);\n        sessionStorage.setItem('intraID', intra_id[1]);\n        sessionStorage.setItem('2auth', 'false');\n      }\n    }\n  });\n\n  const handleAuthCodeChange = (e: any) => {\n    setAuthCode(e.target.value);\n  };\n\n  const authCheck = async () => {\n    const res = await axios.post('/log/2-factor-auth', {\n      intra_id: IntraID,\n      auth_value: AuthCode,\n    });\n\n    if (res.data.auth_result) {\n      sessionStorage.setItem('2auth', 'true');\n      if (res.data.id) {\n        sessionStorage.setItem('nickname', res.data.id);\n        document.location.href = '/lobby';\n      } else document.location.href = '/admin';\n    } else {\n      setWrongCode(true);\n    }\n  };\n\n  return (\n    <div className=\"auth-box\">\n      <div className=\"auth-comment\">\n        {IntraID}@student.42seoul.kr로 메일이 발송되었습니다.\n      </div>\n      <div>\n        <input\n          placeholder=\"인증 코드를 입력해주세요\"\n          onChange={handleAuthCodeChange}\n        />\n        <button onClick={authCheck} className=\"auth-btn\">\n          확인\n        </button>\n      </div>\n      {WrongCode ? <div className=\"wrong-code\">잘못된 코드입니다.</div> : null}\n    </div>\n  );\n};\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}